<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TFT Trading System - Real-Time Market Dashboard</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üìà</text></svg>">

    <!-- External Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/date-fns@2.30.0/index.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/luxon@3.4.3/build/global/luxon.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-luxon@1.3.1/dist/chartjs-adapter-luxon.umd.min.js"></script>

    <!-- Dashboard Core -->
    <link rel="stylesheet" href="/css/dashboard.css?v=20251018-2">
    <link rel="stylesheet" href="/css/dashboard-animations.css?v=20251018-2">
    <script src="/js/api-client.js?v=20251018-2"></script>
    <script src="/js/api-cache.js?v=20251018-2"></script>
    <script src="/js/dashboard-core.js?v=20251018-2"></script>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading-screen" class="loading-screen">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <h2>Initializing Market Dashboard</h2>
            <p>Connecting to real-time data streams...</p>
        </div>
    </div>

    <!-- Main Dashboard Container -->
    <div id="dashboard" class="dashboard-container">
        <!-- Header Bar -->
        <header class="dashboard-header">
            <div class="header-left">
                <div class="logo">
                    <h1>TFT Trading System</h1>
                    <span class="subtitle">Real-Time Market Intelligence</span>
                </div>
            </div>

            <div class="header-center">
                <div class="market-clock" id="market-clock">
                    <div class="clock-time">--:--:--</div>
                    <div class="clock-date">----/--/--</div>
                    <div class="market-status">
                        <span class="status-indicator"></span>
                        <span class="status-text">Market Closed</span>
                    </div>
                </div>
            </div>

            <div class="header-right">
                <div class="header-controls">
                    <button class="theme-toggle" id="theme-toggle" title="Toggle theme">
                        <span class="icon">üåô</span>
                    </button>
                    <button class="refresh-btn" id="refresh-btn" title="Refresh data">
                        <span class="icon">üîÑ</span>
                    </button>
                    <button class="settings-btn" id="settings-btn" title="Dashboard settings">
                        <span class="icon">‚öôÔ∏è</span>
                    </button>
                    <button class="fullscreen-btn" id="fullscreen-btn" title="Toggle fullscreen">
                        <span class="icon">‚õ∂</span>
                    </button>
                </div>
            </div>
        </header>

        <!-- Market Status Bar -->
        <div class="market-status-bar">
            <div class="status-item">
                <span class="label">Market Regime:</span>
                <span class="value regime-indicator" id="regime-indicator">Bullish</span>
            </div>
            <div class="status-item">
                <span class="label">VIX:</span>
                <span class="value volatility-indicator" id="vix-value">--.--</span>
            </div>
            <div class="status-item">
                <span class="label">Sentiment:</span>
                <span class="value sentiment-indicator" id="overall-sentiment">Neutral</span>
            </div>
            <div class="status-item">
                <span class="label">Data Status:</span>
                <span class="value connection-status" id="connection-status">
                    <span class="status-dot connected"></span>
                    Connected
                </span>
            </div>
        </div>

        <!-- Alert Banner -->
        <div class="alert-banner" id="alert-banner" style="display: none;">
            <div class="alert-content">
                <span class="alert-icon">‚ö†Ô∏è</span>
                <span class="alert-message" id="alert-message"></span>
                <button class="alert-close" onclick="dismissAlert()">√ó</button>
            </div>
        </div>

        <!-- Main Dashboard Grid -->
        <main class="dashboard-grid">
            <!-- Top Row: Key Metrics -->
            <section class="grid-section metrics-row">
                <!-- Market Overview Widget -->
                <div class="widget market-overview-widget" data-widget-id="market-overview">
                    <div class="widget-header">
                        <h3>Market Overview</h3>
                        <div class="widget-controls">
                            <button class="widget-refresh" onclick="refreshWidget('market-overview')">üîÑ</button>
                            <button class="widget-settings">‚öôÔ∏è</button>
                        </div>
                    </div>
                    <div class="widget-content">
                        <div class="indices-grid">
                            <div class="index-item">
                                <div class="index-name">S&P 500</div>
                                <div class="index-value" id="sp500-value">--,---</div>
                                <div class="index-change" id="sp500-change">--</div>
                            </div>
                            <div class="index-item">
                                <div class="index-name">NASDAQ</div>
                                <div class="index-value" id="nasdaq-value">--,---</div>
                                <div class="index-change" id="nasdaq-change">--</div>
                            </div>
                            <div class="index-item">
                                <div class="index-name">DOW</div>
                                <div class="index-value" id="dow-value">--,---</div>
                                <div class="index-change" id="dow-change">--</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Predictive Analytics Widget -->
                <div class="widget predictive-widget" data-widget-id="predictive-analytics">
                    <div class="widget-header">
                        <h3>Predictive Analytics</h3>
                        <div class="widget-controls">
                            <button class="widget-refresh" onclick="refreshWidget('predictive-analytics')">üîÑ</button>
                            <button class="widget-settings">‚öôÔ∏è</button>
                        </div>
                    </div>
                    <div class="widget-content">
                        <div class="predictive-metrics">
                            <div class="metric-item">
                                <div class="metric-label">Confidence Score</div>
                                <div class="metric-value">
                                    <div class="confidence-gauge" id="confidence-gauge">
                                        <div class="gauge-fill" style="width: 0%"></div>
                                        <span class="gauge-text">0%</span>
                                    </div>
                                </div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-label">Market Direction</div>
                                <div class="direction-indicator" id="market-direction">
                                    <span class="direction-icon">‚û°Ô∏è</span>
                                    <span class="direction-text">Neutral</span>
                                </div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-label">Risk Level</div>
                                <div class="risk-indicator" id="risk-level">
                                    <span class="risk-text">Moderate</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Real-Time Alerts Widget -->
                <div class="widget alerts-widget" data-widget-id="real-time-alerts">
                    <div class="widget-header">
                        <h3>Real-Time Alerts</h3>
                        <div class="widget-controls">
                            <button class="widget-refresh" onclick="refreshWidget('real-time-alerts')">üîÑ</button>
                            <button class="widget-settings">‚öôÔ∏è</button>
                        </div>
                    </div>
                    <div class="widget-content">
                        <div class="alerts-list" id="alerts-list">
                            <div class="no-alerts">No active alerts</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Middle Row: Charts and Visualizations -->
            <section class="grid-section charts-row">
                <!-- Sentiment Analysis Chart -->
                <div class="widget chart-widget sentiment-chart-widget" data-widget-id="sentiment-chart">
                    <div class="widget-header">
                        <h3>Sentiment Analysis</h3>
                        <div class="widget-controls">
                            <select class="timeframe-selector" id="sentiment-timeframe">
                                <option value="1D">1 Day</option>
                                <option value="1W">1 Week</option>
                                <option value="1M">1 Month</option>
                            </select>
                            <button class="widget-refresh" onclick="refreshWidget('sentiment-chart')">üîÑ</button>
                            <button class="widget-settings">‚öôÔ∏è</button>
                        </div>
                    </div>
                    <div class="widget-content">
                        <canvas id="sentiment-chart" width="400" height="200"></canvas>
                    </div>
                </div>

                <!-- Sector Rotation Heat Map -->
                <div class="widget chart-widget sector-heatmap-widget" data-widget-id="sector-heatmap">
                    <div class="widget-header">
                        <h3>Sector Rotation Heat Map</h3>
                        <div class="widget-controls">
                            <button class="widget-refresh" onclick="refreshWidget('sector-heatmap')">üîÑ</button>
                            <button class="widget-settings">‚öôÔ∏è</button>
                        </div>
                    </div>
                    <div class="widget-content">
                        <div class="sector-heatmap" id="sector-heatmap">
                            <!-- Sectors will be dynamically populated -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- Bottom Row: Detailed Analysis -->
            <section class="grid-section analysis-row">
                <!-- Market Drivers Widget -->
                <div class="widget market-drivers-widget" data-widget-id="market-drivers">
                    <div class="widget-header">
                        <h3>Market Drivers</h3>
                        <div class="widget-controls">
                            <button class="widget-refresh" onclick="refreshWidget('market-drivers')">üîÑ</button>
                            <button class="widget-settings">‚öôÔ∏è</button>
                        </div>
                    </div>
                    <div class="widget-content">
                        <div class="drivers-grid" id="drivers-grid">
                            <div class="driver-item">
                                <div class="driver-label">Economic Growth</div>
                                <div class="driver-value positive">+2.3%</div>
                            </div>
                            <div class="driver-item">
                                <div class="driver-label">Inflation</div>
                                <div class="driver-value neutral">+0.1%</div>
                            </div>
                            <div class="driver-item">
                                <div class="driver-label">Interest Rates</div>
                                <div class="driver-value negative">-0.25%</div>
                            </div>
                            <div class="driver-item">
                                <div class="driver-label">Geopolitical Risk</div>
                                <div class="driver-value moderate">Moderate</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Technical Analysis Widget -->
                <div class="widget technical-widget" data-widget-id="technical-analysis">
                    <div class="widget-header">
                        <h3>Technical Analysis</h3>
                        <div class="widget-controls">
                            <select class="symbol-selector" id="technical-symbol">
                                <option value="SPY">SPY</option>
                                <option value="QQQ">QQQ</option>
                                <option value="AAPL">AAPL</option>
                                <option value="MSFT">MSFT</option>
                                <option value="GOOGL">GOOGL</option>
                            </select>
                            <button class="widget-refresh" onclick="refreshWidget('technical-analysis')">üîÑ</button>
                            <button class="widget-settings">‚öôÔ∏è</button>
                        </div>
                    </div>
                    <div class="widget-content">
                        <canvas id="technical-chart" width="400" height="200"></canvas>
                    </div>
                </div>

                <!-- News & Events Widget -->
                <div class="widget news-widget" data-widget-id="news-events">
                    <div class="widget-header">
                        <h3>Market News & Events</h3>
                        <div class="widget-controls">
                            <button class="widget-refresh" onclick="refreshWidget('news-events')">üîÑ</button>
                            <button class="widget-settings">‚öôÔ∏è</button>
                        </div>
                    </div>
                    <div class="widget-content">
                        <div class="news-list" id="news-list">
                            <div class="no-news">Loading market news...</div>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Settings Modal -->
    <div class="modal" id="settings-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Dashboard Settings</h2>
                <button class="modal-close" onclick="closeModal('settings-modal')">√ó</button>
            </div>
            <div class="modal-body">
                <div class="setting-group">
                    <h3>Refresh Settings</h3>
                    <label>
                        Auto-refresh interval:
                        <select id="refresh-interval">
                            <option value="30">30 seconds</option>
                            <option value="60" selected>1 minute</option>
                            <option value="300">5 minutes</option>
                            <option value="0">Disabled</option>
                        </select>
                    </label>
                </div>

                <div class="setting-group">
                    <h3>Alert Settings</h3>
                    <label>
                        <input type="checkbox" id="enable-alerts" checked>
                        Enable real-time alerts
                    </label>
                    <label>
                        Alert threshold:
                        <input type="number" id="alert-threshold" min="1" max="100" value="70">
                    </label>
                </div>

                <div class="setting-group">
                    <h3>Data Sources</h3>
                    <label>
                        <input type="checkbox" id="use-cache" checked>
                        Use cached data when available
                    </label>
                    <label>
                        <input type="checkbox" id="enable-realtime" checked>
                        Enable real-time streaming
                    </label>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-primary" onclick="saveSettings()">Save Settings</button>
                <button class="btn-secondary" onclick="closeModal('settings-modal')">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Dashboard JavaScript -->
    <script src="/js/dashboard-main.js?v=20251018-2"></script>

    <!-- API Client Initialization -->
    <script>
        // Initialize CCT API Client
        window.cctApi = new CCTApiClient({
            baseUrl: window.location.origin,
            apiKey: localStorage.getItem('cct_api_key') || 'yanggf',
            timeout: 30000,
            enableCache: true,
            cacheTimeout: 300000 // 5 minutes
        });

        // Make API client available globally
        console.log('CCT API Client initialized:', window.cctApi);
    </script>
</body>
</html>