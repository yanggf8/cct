# ðŸš€ Neural Network Deployment Guide

## Overview
This package contains trained TFT and N-HITS neural networks for financial prediction.

## Model Performance
- **TFT Model**: 55.3% direction accuracy (53,803 parameters)
- **N-HITS Model**: 46.7% direction accuracy (29,825 parameters)
- **Training Data**: 2y of market data (1,800 training samples)
- **Validation**: 450 samples

## Files Included
- `deployment_metadata.json`: Complete training and performance metadata
- `tft_weights.json`: TFT model weights and architecture
- `nhits_weights.json`: N-HITS model weights and architecture
- `cloudflare_inference.js`: JavaScript inference implementation
- `DEPLOYMENT_GUIDE.md`: This guide

## Cloudflare Workers Deployment

### 1. Upload to R2 Storage
```bash
wrangler r2 object put tft-trading-models/deployment_metadata.json --file=deployment_metadata.json
wrangler r2 object put tft-trading-models/tft_weights.json --file=tft_weights.json
wrangler r2 object put tft-trading-models/nhits_weights.json --file=nhits_weights.json
```

### 2. Update Worker Code
Replace your existing model inference code with the generated JavaScript implementation.

### 3. Deploy
```bash
wrangler deploy
```

### 4. Verify Deployment
```bash
curl -X POST "https://your-worker.workers.dev/analyze" \
     -H "Content-Type: application/json" \
     -d '{"symbols": ["AAPL"], "test_mode": true}'
```

Look for `inference_type: 'genuine_neural_network'` in the response.

## Model Ensemble
For best results, use ensemble prediction:
- TFT weight: 55%
- N-HITS weight: 45%

## Technical Details
- **Input**: 30-day sequences of OHLCV + VWAP data
- **Output**: Next-day price change percentage
- **Normalization**: MinMaxScaler per symbol
- **Framework**: TensorFlow 2.19.0
- **Training Date**: 2025-09-16 04:57 UTC

## Support
Generated by Enhanced TFT + N-HITS Training Pipeline
